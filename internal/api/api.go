package api

import (
	"net/http"

	env "github.com/csye7125-su24-team06/webapp-cve-consumer/internal"
	"github.com/csye7125-su24-team06/webapp-cve-consumer/internal/handler"
	"github.com/prometheus/client_golang/prometheus/promhttp"
	"github.com/sirupsen/logrus"
)

var Server *http.Server

func StartServer() {
	port := env.GetEnvOrDefault("PORT", "3001")

	Server = &http.Server{
		Addr: ":" + port,
	}

	http.HandleFunc("/readiness", handler.ReadinessCheck)
	http.HandleFunc("/liveness", handler.LivenessCheck)
	http.Handle("/metrics", promhttp.Handler())

	logrus.Println("Starting Server...")
	Server.ListenAndServe()
}
